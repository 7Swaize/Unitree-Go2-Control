<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>src.core.unitree_control_core &#8212; Unitree-Go2-Control 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for src.core.unitree_control_core</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Core Controller Module for Student Use</span>
<span class="sd">======================================</span>

<span class="sd">This module provides the **primary public API** for controlling the Unitree Go2</span>
<span class="sd">robot.</span>

<span class="sd">Students interact exclusively with :class:`UnitreeGo2Controller`, which exposes</span>
<span class="sd">high-level functionality such as movement, video, audio, OCR, input, and LIDAR</span>
<span class="sd">through strongly-typed properties.</span>

<span class="sd">Design Goals</span>
<span class="sd">------------</span>
<span class="sd">    - Provide a **single entry point** for all robot capabilities</span>
<span class="sd">    - Hide hardware and SDK complexity behind safe abstractions</span>
<span class="sd">    - Support both **real hardware** and **simulation** transparently</span>
<span class="sd">    - Enforce clean startup and shutdown semantics</span>

<span class="sd">Usage Model</span>
<span class="sd">-----------</span>
<span class="sd">Students:</span>
<span class="sd">    - Create a controller</span>
<span class="sd">    - Access modules via properties (e.g., ``controller.movement``)</span>
<span class="sd">    - Write behavior/state logic on top of this API</span>

<span class="sd">Internal systems:</span>
<span class="sd">    - Manage hardware backends</span>
<span class="sd">    - Handle module registration and lifecycle</span>
<span class="sd">    - Enforce safety checks during shutdown</span>

<span class="sd">Example</span>
<span class="sd">-------</span>
<span class="sd">&gt;&gt;&gt; import time</span>
<span class="sd">&gt;&gt;&gt; from src.core.unitree_control_core import UnitreeGo2Controller</span>
<span class="sd">&gt;&gt;&gt; </span>
<span class="sd">&gt;&gt;&gt; unitree_controller = UnitreeGo2Controller(use_sdk=True)</span>
<span class="sd">&gt;&gt;&gt; unitree_controller.movement.stand_up()</span>
<span class="sd">&gt;&gt;&gt; time.sleep(1)</span>
<span class="sd">&gt;&gt;&gt; unitree_controller.safe_shutdown()</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">src.controller_input_control.input_signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputSignal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.core.base_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">DogModule</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.core.module_registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">AudioModule</span><span class="p">,</span> <span class="n">InputModule</span><span class="p">,</span> <span class="n">ModuleRegistry</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">,</span> <span class="n">MovementModule</span><span class="p">,</span> <span class="n">OCRModule</span><span class="p">,</span> <span class="n">VideoModule</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.core.hardware_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">HardwareInterface</span><span class="p">,</span> <span class="n">SimulatedHardware</span><span class="p">,</span> <span class="n">UnitreeSDKHardware</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.lidar_control.decoder</span><span class="w"> </span><span class="kn">import</span> <span class="n">LIDARModule</span>


<span class="c1"># TTS: https://medium.com/@vndee.huynh/build-your-own-voice-assistant-and-run-it-locally-whisper-ollama-bark-c80e6f815cba</span>
<span class="c1"># Digging into Dog: https://www.darknavy.org/darknavy_insight/the_jailbroken_unitree_robot_dog</span>

<span class="c1"># Github Repo Searcher: https://github.com/search?type=Code</span>

<span class="c1"># Some very interesting turtorial with the G02: https://hackmd.io/@c12hQ00ySVi6JYIERU7bCg/ByAOr12qJg</span>

<span class="c1"># Update to JetPack 6.x on Dog&#39;s Jetson: https://theroboverse.com/unitree-go2-edu-jetpack-6-2-1-update/</span>


<div class="viewcode-block" id="UnitreeGo2Controller">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">UnitreeGo2Controller</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">    Primary control interface for the Unitree Go2 robot.</span>

<span class="sd">    This class is the **main entry point** that students and users interact with.</span>
<span class="sd">    It manages hardware initialization, module lifecycles, safety checks, and</span>
<span class="sd">    shutdown coordination.</span>

<span class="sd">    Modules are accessed via typed properties rather than direct instantiation,</span>
<span class="sd">    ensuring compile-time safety and consistent behavior.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        - All hardware access is routed through this controller.</span>
<span class="sd">        - Modules are created and initialized automatically.</span>
<span class="sd">        - Accessing modules after shutdown is prohibited.</span>
<span class="sd">        - Supports both SDK-backed hardware and simulation.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    DogModule</span>
<span class="sd">    ModuleRegistry</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_sdk</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new controller instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        use_sdk : bool or None</span>
<span class="sd">            If ``True``, forces use of the Unitree SDK.</span>
<span class="sd">            If ``False``, forces simulation mode.</span>
<span class="sd">            If ``None``, SDK availability is auto-detected.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If hardware initialization fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">use_sdk</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">use_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_sdk</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_sdk</span> <span class="o">=</span> <span class="n">use_sdk</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_callbacks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_hardware</span><span class="p">:</span> <span class="n">HardwareInterface</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">UnitreeSDKHardware</span><span class="p">()</span> <span class="k">if</span> <span class="n">use_sdk</span> <span class="k">else</span> <span class="n">SimulatedHardware</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hardware</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">DogModule</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_default_modules</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_input_bindings</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Controller] Initialized in </span><span class="si">{</span><span class="s1">&#39;SDK&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">use_sdk</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;SIMULATION&#39;</span><span class="si">}</span><span class="s2"> mode</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_sdk</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">unitree_sdk2py</span>
            <span class="k">return</span> <span class="kc">True</span>
        
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_input_bindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sdk</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span>
                <span class="n">InputSignal</span><span class="o">.</span><span class="n">BUTTON_A</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_event</span><span class="o">.</span><span class="n">set</span><span class="p">(),</span>
                <span class="s2">&quot;emergency_stop&quot;</span>
            <span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_register_default_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">MOVEMENT</span><span class="p">,</span> <span class="n">hardware</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_hardware</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sdk</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">INPUT</span><span class="p">,</span> <span class="n">use_sdk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_sdk</span><span class="p">)</span>


<div class="viewcode-block" id="UnitreeGo2Controller.add_module">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller.add_module">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_type</span><span class="p">:</span> <span class="n">ModuleType</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a module to the controller.</span>

<span class="sd">        Modules are identified using :class:`ModuleType` enums to ensure</span>
<span class="sd">        correctness and prevent invalid configurations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_type : ModuleType</span>
<span class="sd">            The type of module to add.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Constructor arguments passed to the module implementation.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module type is not registered.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - SDK-required modules are skipped automatically in simulation mode.</span>
<span class="sd">        - Modules are initialized immediately upon addition.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; controller.add_module(ModuleType.VIDEO)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">ModuleRegistry</span><span class="o">.</span><span class="n">get_descriptor</span><span class="p">(</span><span class="n">module_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module type </span><span class="si">{</span><span class="n">module_type</span><span class="si">}</span><span class="s2"> is not registered&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">requires_sdk</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sdk</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Controller] Warning: </span><span class="si">{</span><span class="n">module_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> requires SDK mode&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="n">module</span><span class="p">:</span> <span class="n">DogModule</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">create_instance</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="n">module</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span></div>

    

<div class="viewcode-block" id="UnitreeGo2Controller.has_module">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller.has_module">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_type</span><span class="p">:</span> <span class="n">ModuleType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether a module is currently loaded.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">module_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span></div>

    
    
<div class="viewcode-block" id="UnitreeGo2Controller.get_available_modules">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller.get_available_modules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_available_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ModuleType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all module types available in the current mode.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of ModuleType</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ModuleRegistry</span><span class="o">.</span><span class="n">get_list_available</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_sdk</span><span class="p">)</span></div>

    

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">video</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VideoModule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the video capture module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        VideoModule</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the module is not loaded or shutdown has been requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">VIDEO</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">VideoModule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Video module not loaded&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown_requested</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot access Video module after shutdown has been requested&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">module</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">movement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MovementModule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the movement control module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MovementModule</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the module is not loaded or shutdown has been requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">MOVEMENT</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">MovementModule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Movement module not loaded&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown_requested</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot access Movement module after shutdown has been requested&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">module</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ocr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OCRModule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the ocr control module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OCRModule</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the module is not loaded or shutdown has been requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">OCR</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">OCRModule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;OCR module not loaded&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown_requested</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot access OCR module after shutdown has been requested&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">module</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">audio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AudioModule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the audio control module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AudioModule</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the module is not loaded or shutdown has been requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">AUDIO</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">AudioModule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Audio module not loaded&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown_requested</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot access Audio module after shutdown has been requested&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">module</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InputModule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the input control module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        InputMOdule</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the module is not loaded or shutdown has been requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">INPUT</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">InputModule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Input module not loaded&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown_requested</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot access Input module after shutdown has been requested&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">module</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lidar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LIDARModule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the lidar control module.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        LIDARModule</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the module is not loaded or shutdown has been requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ModuleType</span><span class="o">.</span><span class="n">LIDAR</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">LIDARModule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;LIDAR module not loaded&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown_requested</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot access LIDAR module after shutdown has been requested&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">module</span>
    

<div class="viewcode-block" id="UnitreeGo2Controller.register_cleanup_callback">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller.register_cleanup_callback">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_cleanup_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a cleanup callback.</span>

<span class="sd">        Callbacks are executed during safe shutdown after modules are stopped</span>
<span class="sd">        but before hardware is released.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : callable</span>
<span class="sd">            Zero-argument function to execute during shutdown.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span></div>



<div class="viewcode-block" id="UnitreeGo2Controller.safe_shutdown">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller.safe_shutdown">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">safe_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform a coordinated and safe shutdown.</span>

<span class="sd">        This method:</span>
<span class="sd">            - Stops movement immediately</span>
<span class="sd">            - Signals shutdown to all subsystems</span>
<span class="sd">            - Shuts down all modules</span>
<span class="sd">            - Executes registered cleanup callbacks</span>
<span class="sd">            - Releases hardware resources</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method is **idempotent** and may be safely called multiple times.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Controller] Starting safe shutdown...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movement</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">module_type</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">module</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Controller] Failed to shutdown </span><span class="si">{</span><span class="n">module_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_callbacks</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">callback</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Controller] Cleanup callback failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_hardware</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Controller] Hardware shutdown failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Controller] Shutdown complete&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="UnitreeGo2Controller.is_shutdown_requested">
<a class="viewcode-back" href="../../../api/core.html#src.core.unitree_control_core.UnitreeGo2Controller.is_shutdown_requested">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_shutdown_requested</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if shutdown has been requested&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span></div>
</div>


    
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Unitree-Go2-Control</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">Public API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../internal/index.html">Internal Implementation Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, Sachit Raheja.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>